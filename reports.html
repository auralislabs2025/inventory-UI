<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reports - InventoryPro</title>
  <style>
    :root {
      --primary:#4361ee; --success:#06d6a0; --warning:#ff9f1c; --danger:#ef476f;
      --dark:#2c3e50; --light:#f8f9fa; --gray:#adb5bd;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f8f9fa;color:#333}
    .app{display:flex;min-height:100vh}
    .sidebar{width:260px;background:#2c3e50;color:white;padding:20px 0;flex-shrink:0}
    .sidebar .logo{padding:0 25px;font-size:1.6rem;font-weight:bold;margin-bottom:30px}
    .sidebar ul{list-style:none}
    .sidebar li a{display:block;padding:15px 25px;color:white;text-decoration:none}
    .sidebar li.active,.sidebar li:hover{background:#34495e}
    .main{flex:1}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:15px 30px;background:white;box-shadow:0 2px 15px rgba(0,0,0,0.1)}
    .topbar button{background:none;border:none;font-size:1.5rem;cursor:pointer}
    .global-search{width:380px;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:1rem}
    .content{padding:30px}
    h1{color:#2c3e50;margin-bottom:25px;font-size:1.8rem}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;margin-bottom:40px}
    .card{background:white;padding:25px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.08);text-align:center}
    .card h3{font-size:1rem;color:#666;margin-bottom:12px}
    .card .value{font-size:2.4rem;font-weight:bold;margin:10px 0}
    .card .change{color:var(--success);font-size:0.9rem}
    .chart-card{background:white;padding:30px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.08);margin-bottom:30px}
    .chart-title{font-size:1.3rem;font-weight:600;margin-bottom:20px;color:#2c3e50}
    .btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-weight:500}
    .btn-primary{background:var(--primary);color:white}
    .toast{position:fixed;bottom:30px;right:30px;background:#333;color:white;padding:16px 28px;border-radius:8px;opacity:0;transition:.3s;z-index:3000;box-shadow:0 5px 20px rgba(0,0,0,0.3)}
    .toast.show{opacity:1;transform:translateY(-10px)}
    .sidebar-backdrop{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.5);
      z-index:998;
      opacity:0;
      transition:opacity .3s;
      pointer-events:none;
    }
    .sidebar-backdrop.show{
      display:block;
      opacity:1;
      pointer-events:auto;
    }
    @media(max-width:768px){
      .sidebar{
        position:fixed;
        left:-260px;
        z-index:999;
        transition:.3s;
        box-shadow:2px 0 20px rgba(0,0,0,.2);
      }
      .sidebar.open{left:0}
      .topbar{
        flex-wrap:wrap;
        gap:10px;
        padding:12px 16px;
      }
      .global-search{width:100%;margin:10px 0}
      .content{padding:16px}
      h1{font-size:1.5rem;margin-bottom:20px}
      .grid{grid-template-columns:1fr;gap:16px}
      .card{padding:20px}
      .chart-card{padding:20px}
      .btn{
        padding:12px 16px;
        min-height:44px;
        font-size:1rem;
      }
    }
    @media(max-width:480px){
      .content{padding:12px}
      h1{font-size:1.3rem}
      .card{padding:16px}
      .chart-card{padding:16px}
    }
  </style>
</head>
<body>

<div class="app">
  <aside class="sidebar" id="sidebar">
    <div class="logo">InventoryPro</div>
    <ul>
      <li><a href="index.html">Dashboard</a></li>
      <li><a href="inventory.html">Inventory</a></li>
      <li><a href="suppliers.html">Suppliers</a></li>
      <li><a href="purchases.html">Purchases</a></li>
      <li><a href="adjustments.html">Adjustments</a></li>
      <li class="active"><a href="reports.html">Reports</a></li>
      <li><a href="settings.html">Settings</a></li>
    </ul>
  </aside>

  <div class="main">
    <header class="topbar">
      <button class="menu-btn" onclick="toggleSidebar()" aria-label="Toggle menu">â˜°</button>
      <div style="font-size:1.4rem;font-weight:600;color:#2c3e50">Reports & Analytics</div>
      <div>
        <select onchange="document.body.className=this.value;localStorage.setItem('theme',this.value)">
          <option value="">Light</option>
          <option value="dark">Dark</option>
        </select>
        <span style="margin-left:20px;background:var(--primary);color:white;padding:10px 14px;border-radius:50%;font-weight:bold">AD</span>
      </div>
    </header>

    <main class="content">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:30px">
        <h1>Analytics Overview</h1>
        <button class="btn btn-primary" onclick="showToast('Report exported as PDF')">Export Report</button>
      </div>

      <!-- KPI Cards -->
      <div class="grid">
        <div class="card">
          <h3>Total Inventory Value</h3>
          <div class="value" id="totalValue">$0</div>
          <div class="change">+12.5% from last month</div>
        </div>
        <div class="card">
          <h3>Items in Stock</h3>
          <div class="value" id="totalItems">0</div>
          <div class="change">Across 4 categories</div>
        </div>
        <div class="card">
          <h3>Low Stock Items</h3>
          <div class="value" id="lowStock">0</div>
          <div class="change" style="color:var(--warning)">Requires attention</div>
        </div>
        <div class="card">
          <h3>Out of Stock</h3>
          <div class="value" id="outOfStock" style="color:var(--danger)">0</div>
          <div class="change">Critical</div>
        </div>
        <div class="card">
          <h3>Inventory Turnover</h3>
          <div class="value">4.8x</div>
          <div class="change">Healthy rate</div>
        </div>
        <div class="card">
          <h3>Avg Days in Stock</h3>
          <div class="value">42</div>
          <div class="change">-8 days vs last month</div>
        </div>
      </div>

      <!-- Charts -->
      <div class="grid" style="grid-template-columns:1fr 1fr;gap:30px">
        <div class="chart-card">
          <div class="chart-title">Stock Value Trend (Last 6 Months)</div>
          <svg viewBox="0 0 600 250" style="width:100%;height:250px">
            <polyline fill="none" stroke="#4361ee" stroke-width="4" points="50,200 150,160 250,120 350,100 450,80 550,110"/>
            <text x="50" y="220" fill="#666">Jul</text>
            <text x="150" y="220" fill="#666">Aug</text>
            <text x="250" y="220" fill="#666">Sep</text>
            <text x="350" y="220" fill="#666">Oct</text>
            <text x="450" y="220" fill="#666">Nov</text>
            <text x="550" y="220" fill="#666">Dec</text>
          </svg>
        </div>

        <div class="chart-card">
          <div class="chart-title">Top Selling Items</div>
          <svg viewBox="0 0 600 250" style="width:100%;height:250px">
            <rect x="80" y="180" width="80" height="70" fill="#4361ee"/>
            <rect x="200" y="120" width="80" height="130" fill="#06d6a0"/>
            <rect x="320" y="90" width="80" height="160" fill="#ff9f1c"/>
            <rect x="440" y="150" width="80" height="100" fill="#adb5bd"/>
            <text x="120" y="270" text-anchor="middle" fill="#666">Laptop</text>
            <text x="240" y="270" text-anchor="middle" fill="#666">Mouse</text>
            <text x="360" y="270" text-anchor="middle" fill="#666">Keyboard</text>
            <text x="480" y="270" text-anchor="middle" fill="#666">Hub</text>
          </svg>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-title">Stock by Category</div>
        <svg viewBox="0 0 600 300" style="width:100%;height:300px">
          <circle cx="300" cy="150" r="100" fill="none" stroke="#4361ee" stroke-width="80" stroke-dasharray="200 628"/>
          <circle cx="300" cy="150" r="100" fill="none" stroke="#06d6a0" stroke-width="80" stroke-dasharray="150 628" transform="rotate(90 300 150)"/>
          <circle cx="300" cy="150" r="100" fill="none" stroke="#ff9f1c" stroke-width="80" stroke-dasharray="100 628" transform="rotate(180 300 150)"/>
          <circle cx="300" cy="150" r="100" fill="none" stroke="#adb5bd" stroke-width="80" stroke-dasharray="178 628" transform="rotate(270 300 150)"/>
          <text x="300" y="100" text-anchor="middle" font-size="18">Electronics 32%</text>
          <text x="300" y="200" text-anchor="middle" font-size="18">Accessories 48%</text>
          <text x="200" y="150" text-anchor="middle" font-size="16">Cables 16%</text>
          <text x="400" y="150" text-anchor="middle" font-size="16">Other 4%</text>
        </svg>
      </div>

      <div class="chart-card">
        <div class="chart-title">Recent Adjustments</div>
        <table style="width:100%">
          <thead>
            <tr><th>Date</th><th>Item</th><th>Change</th><th>Reason</th></tr>
          </thead>
          <tbody id="recentAdj">
            <!-- Filled by JS -->
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <div id="toast" class="toast"></div>
</div>

<script>
  // Load real data from localStorage
  const inventory = JSON.parse(localStorage.getItem('inventory') || '[]');
  const adjustments = JSON.parse(localStorage.getItem('adjustments') || '[]');

  // Calculate KPIs
  const totalValue = inventory.reduce((sum,i)=>sum + (i.quantity||0)*(i.price||0),0);
  const totalItems = inventory.length;
  const lowStock = inventory.filter(i=>i.quantity < 10).length;
  const outOfStock = inventory.filter(i=>i.quantity === 0).length;

  document.getElementById('totalValue').textContent = '$' + totalValue.toLocaleString();
  document.getElementById('totalItems').textContent = totalItems;
  document.getElementById('lowStock').textContent = lowStock;
  document.getElementById('outOfStock').textContent = outOfStock;

  // Recent adjustments
  const recent = adjustments.slice(0,5).sort((a,b)=>new Date(b.date)-new Date(a.date));
  const tbody = document.getElementById('recentAdj');
  tbody.innerHTML = recent.map(a=>`
    <tr>
      <td>${a.date}</td>
      <td>${a.name || a.sku}</td>
      <td style="color:${a.change>0?'#06d6a0':'#ef476f'}"><strong>${a.change>0?'+':''}${a.change}</strong></td>
      <td>${a.reason}</td>
    </tr>
  `).join('');

  function showToast(msg){
    const t=document.getElementById('toast');
    t.textContent=msg;
    t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'),3000);
  }

  // Sidebar functions
  function toggleSidebar(){
    const sidebar = document.getElementById('sidebar');
    const backdrop = document.getElementById('sidebarBackdrop');
    if(sidebar && backdrop){
      sidebar.classList.toggle('open');
      backdrop.classList.toggle('show');
    }
  }
  function closeSidebar(){
    const sidebar = document.getElementById('sidebar');
    const backdrop = document.getElementById('sidebarBackdrop');
    if(sidebar && backdrop){
      sidebar.classList.remove('open');
      backdrop.classList.remove('show');
    }
  }
  
  // Close sidebar on nav click
  document.querySelectorAll('.sidebar a').forEach(link => {
    link.addEventListener('click', () => {
      if(window.innerWidth <= 768) closeSidebar();
    });
  });
  
  document.body.className = localStorage.getItem('theme')||'';
</script>
</body>
</html>