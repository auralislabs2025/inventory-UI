<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>InventoryPro â€“ Mobile Route Planner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <meta name="theme-color" content="#4361ee"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
  <meta name="apple-mobile-web-app-title" content="InventoryPro"/>
  <link rel="manifest" href="manifest.json"/>
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png"/>
  <link rel="stylesheet" href="mobile.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <button id="hamburger" aria-label="Open menu">â˜°</button>
  <div>
    <h2 id="pageTitle">Route Planner</h2>
    <span id="activeWarehouseLabel">Trivandrum Central Godown</span>
  </div>
</header>

<!-- DASHBOARD VIEW -->
<div id="dashboardView">
  <!-- WAREHOUSE SELECTOR (MAIN DASHBOARD) -->
  <section class="warehouse-card">
    <label>Start From Warehouse</label>
    <select id="warehouseSelect"></select>
    <div id="warehouseInfo" class="warehouse-info"></div>
  </section>

  <!-- BEST ROUTE CARD -->
  <section class="best-route" id="bestRouteCard">
    <div class="badge">â­ BEST ROUTE</div>
    <h3 id="bestRouteName">â€“</h3>
    <div class="metrics">
      <div>
        <label>Revenue</label>
        <strong id="bestRevenue">â€“</strong>
      </div>
      <div>
        <label>Distance</label>
        <strong id="bestKm">â€“</strong>
      </div>
      <div>
        <label>â‚¹ / KM</label>
        <strong id="bestScore">â€“</strong>
      </div>
    </div>
    <button id="openMapBtn" class="primary-btn">View Route</button>
  </section>

  <!-- FLEET STATUS (QUICK VIEW) -->
  <section class="fleet-quick" id="fleetQuickView">
    <div class="fleet-header">
      <h4>Fleet Status</h4>
      <button class="link-btn" onclick="navigateToPage('fleet')">Manage â†’</button>
    </div>
    <div class="fleet-stats">
      <div>
        <strong id="fleetAvailable">0</strong>
        <span>Available</span>
      </div>
      <div>
        <strong id="fleetAssigned">0</strong>
        <span>Assigned</span>
      </div>
      <div>
        <strong id="fleetOnRoute">0</strong>
        <span>On Route</span>
      </div>
    </div>
  </section>

  <!-- ROUTES LIST -->
  <section class="routes">
    <h4>Delivery Clusters</h4>
    <div id="routeList"></div>
  </section>
</div>

<!-- ROUTES VIEW -->
<div id="routesView" style="display: none;">
  <section class="routes">
    <div style="margin: 16px 16px 0;">
      <div id="routesSearchContainer" class="search-wrapper"></div>
    </div>
    <h4 style="margin: 16px;">All Routes</h4>
    <div id="allRoutesList"></div>
  </section>
</div>

<!-- FLEET VIEW -->
<div id="fleetView" style="display: none;">
  <section class="page-content">
    <div class="fleet-stats">
      <div>
        <strong id="mobileFleetTotal">0</strong>
        <span>Total</span>
      </div>
      <div>
        <strong id="mobileFleetAvailable">0</strong>
        <span>Available</span>
      </div>
      <div>
        <strong id="mobileFleetAssigned">0</strong>
        <span>Assigned</span>
      </div>
    </div>
    <div id="fleetSearchContainer" class="search-wrapper" style="margin: 16px;"></div>
    <div id="fleetList"></div>
  </section>
</div>

<!-- ORDERS VIEW -->
<div id="ordersView" style="display: none;">
  <section class="page-content">
    <div id="ordersSearchContainer" class="search-wrapper"></div>
    <div id="ordersList"></div>
  </section>
</div>

<!-- INVENTORY VIEW -->
<div id="inventoryView" style="display: none;">
  <section class="page-content">
    <div id="inventorySearchContainer" class="search-wrapper"></div>
    <div id="inventoryList"></div>
  </section>
</div>

<!-- ANALYTICS VIEW -->
<div id="analyticsView" style="display: none;">
  <section class="page-content">
    <div class="analytics-stats">
      <div class="stat-card">
        <label>Revenue</label>
        <strong>â‚¹45.2L</strong>
      </div>
      <div class="stat-card">
        <label>Orders</label>
        <strong>234</strong>
      </div>
      <div class="stat-card">
        <label>Routes</label>
        <strong>48</strong>
      </div>
    </div>
    <div id="analyticsContent"></div>
  </section>
</div>

<!-- SETTINGS VIEW -->
<div id="settingsView" style="display: none;">
  <section class="page-content">
    <div id="settingsContent"></div>
  </section>
</div>

<!-- BOTTOM ACTION BAR -->
<div class="bottom-bar">
  <button class="action-btn" onclick="navigateToPage('routes')">
    <span>ğŸ§­</span>
    <span>Routes</span>
  </button>
  <button class="action-btn active" onclick="navigateToPage('dashboard')">
    <span>ğŸ“Š</span>
    <span>Dashboard</span>
  </button>
  <button class="action-btn" onclick="navigateToPage('fleet')">
    <span>ğŸšš</span>
    <span>Fleet</span>
  </button>
  <button class="action-btn" onclick="navigateToPage('analytics')">
    <span>ğŸ“ˆ</span>
    <span>Analytics</span>
  </button>
</div>

<!-- HAMBURGER DRAWER -->
<div id="drawerBackdrop" class="drawer-backdrop"></div>
<aside id="drawer" class="drawer">
  <div class="drawer-header">
    <h3>InventoryPro</h3>
    <button id="closeDrawer" aria-label="Close menu">âœ–</button>
  </div>
  <hr/>
  <nav>
    <button onclick="navigateToPage('dashboard'); closeDrawer();">
      <span>ğŸ </span>
      <span>Dashboard</span>
    </button>
    <button onclick="navigateToPage('routes'); closeDrawer();">
      <span>ğŸ§­</span>
      <span>Routes</span>
    </button>
    <button onclick="navigateToPage('fleet'); closeDrawer();">
      <span>ğŸšš</span>
      <span>Fleet</span>
    </button>
    <button onclick="navigateToPage('orders'); closeDrawer();">
      <span>ğŸ“¦</span>
      <span>Orders</span>
    </button>
    <button onclick="navigateToPage('inventory'); closeDrawer();">
      <span>ğŸ“‹</span>
      <span>Inventory</span>
    </button>
    <button onclick="navigateToPage('analytics'); closeDrawer();">
      <span>ğŸ“Š</span>
      <span>Analytics</span>
    </button>
    <button onclick="navigateToPage('settings'); closeDrawer();">
      <span>âš™ï¸</span>
      <span>Settings</span>
    </button>
  </nav>
</aside>

<!-- MAP OVERLAY -->
<div id="mapOverlay" class="map-overlay">
  <div class="map-header">
    <span id="mapTitle">Route</span>
    <button id="closeMap" aria-label="Close map">âœ–</button>
  </div>
  <div id="map"></div>
  <div class="map-actions">
    <button id="assignVehicleBtn" class="action-btn-map">ğŸšš Assign Vehicle</button>
    <button id="startRouteBtn" class="action-btn-map primary">â–¶ Start Delivery</button>
  </div>
</div>

<!-- ROUTE EXECUTION OVERLAY -->
<div id="executionOverlay" class="execution-overlay">
  <div class="exec-header">
    <span id="execRouteName">Route Name</span>
    <button id="closeExec" aria-label="Close route execution">âœ–</button>
  </div>
  <div class="exec-stops" id="execStopsList"></div>
  <div class="exec-actions">
    <button class="exec-btn" onclick="callRetailer()">ğŸ“ Call</button>
    <button class="exec-btn primary" onclick="markStopComplete()">âœ… Complete</button>
  </div>
</div>

<!-- FLEET ASSIGNMENT MODAL -->
<div id="fleetModal" class="modal">
  <div class="modal-content">
    <button class="close-modal" onclick="closeFleetModal()" aria-label="Close modal">âœ–</button>
    <h3>Assign Vehicle</h3>
    <div id="fleetSelectList"></div>
    <button class="primary-btn" onclick="confirmFleetAssignment()">Assign</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="mobile.js"></script>
<script>
  // Register Service Worker for PWA
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js')
        .then((registration) => {
          console.log('Service Worker registered:', registration);
        })
        .catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
    });
  }
</script>
</body>
</html>
