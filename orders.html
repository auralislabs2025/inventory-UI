<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders - InventoryPro</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
      :root {
        --primary:#4361ee; --success:#06d6a0; --warning:#ff9f1c; --danger:#ef476f;
        --dark:#2c3e50; --muted:#6c757d; --bg:#f8f9fa; --card:#ffffff;
      }
      *{margin:0;padding:0;box-sizing:border-box}
      body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:var(--bg);color:#333}
      .app{display:flex;min-height:100vh}
      .sidebar{width:260px;background:var(--dark);color:white;padding:20px 0;flex-shrink:0;transition:left .3s}
      .sidebar .logo{padding:0 25px;font-size:1.6rem;font-weight:bold;margin-bottom:30px}
      .sidebar ul{list-style:none}
      .sidebar li a{display:block;padding:15px 25px;color:white;text-decoration:none}
      .sidebar li.active,.sidebar li:hover{background:#34495e}
      .main{flex:1;display:flex;flex-direction:column}
      .topbar{display:flex;justify-content:space-between;align-items:center;padding:15px 30px;background:white;box-shadow:0 2px 15px rgba(0,0,0,.1);z-index:10}
      .menu-btn{background:none;border:none;font-size:1.6rem;cursor:pointer;color:#333}
      .global-search{width:380px;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:1rem}
      .content{flex:1;padding:30px;overflow-y:auto}
      h1{color:var(--dark);margin-bottom:25px;font-size:1.9rem}
      .btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-weight:500;font-size:0.95rem;transition:.2s}
      .btn-primary{background:var(--primary);color:white}
      .btn-success{background:var(--success);color:white}
      .btn-danger{background:var(--danger);color:white}
      .table-container{background:white;border-radius:12px;overflow:hidden;box-shadow:0 5px 25px rgba(0,0,0,.08);overflow-x:auto}
      table{width:100%;min-width:800px;border-collapse:collapse}
      th,td{padding:16px 18px;text-align:left;border-bottom:1px solid #eee;vertical-align:middle}
      th{font-weight:600;color:#444;background:#f8f9fa}
      tr:hover{background:#f8f9fa}
      .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:2000;justify-content:center;align-items:center;padding:20px}
      .modal.open{display:flex}
      .modal-content{background:white;padding:35px;border-radius:12px;width:90%;max-width:620px;max-height:90vh;overflow-y:auto;position:relative;box-shadow:0 20px 60px rgba(0,0,0,.3)}
      .close{position:absolute;top:15px;right:20px;background:none;border:none;font-size:32px;cursor:pointer;color:#999}
      .form-group{margin-bottom:22px}
      .form-group label{display:block;margin-bottom:8px;font-weight:500;color:#444}
      .form-group input,.form-group select{width:100%;padding:12px 14px;border:1px solid #ddd;border-radius:8px;font-size:1rem}
      .sidebar-backdrop{
        display:none;
        position:fixed;
        inset:0;
        background:rgba(0,0,0,.5);
        z-index:998;
        opacity:0;
        transition:opacity .3s;
        pointer-events:none;
      }
      .sidebar-backdrop.show{
        display:block;
        opacity:1;
        pointer-events:auto;
      }
      .mobile-card-view{display:none}
      .mobile-card{
        background:white;
        padding:16px;
        border-radius:12px;
        margin-bottom:12px;
        box-shadow:0 2px 8px rgba(0,0,0,.1);
        border-left:4px solid var(--primary);
      }
      .mobile-card-header{
        display:flex;
        justify-content:space-between;
        align-items:start;
        margin-bottom:12px;
        padding-bottom:12px;
        border-bottom:1px solid #f0f0f0;
      }
      .mobile-card-title{font-weight:700;color:var(--dark);font-size:1rem}
      .mobile-card-row{
        display:flex;
        justify-content:space-between;
        padding:8px 0;
        border-bottom:1px solid #f0f0f0;
      }
      .mobile-card-row:last-child{border-bottom:none}
      .mobile-card-label{color:var(--muted);font-size:0.9rem}
      .mobile-card-value{font-weight:600;color:var(--dark)}
      .mobile-card-actions{
        display:flex;
        gap:8px;
        margin-top:12px;
        flex-wrap:wrap;
      }
      .mobile-card-actions .btn{flex:1;min-width:80px}
      @media(max-width:768px){
        .sidebar{
          position:fixed;
          top:0;
          left:-260px;
          height:100vh;
          z-index:999;
          box-shadow:2px 0 20px rgba(0,0,0,.2);
        }
        .sidebar.open{left:0}
        .topbar{
          flex-wrap:wrap;
          gap:10px;
          padding:12px 16px;
        }
        .global-search{width:100%;margin-bottom:8px}
        .content{padding:16px}
        h1{font-size:1.5rem;margin-bottom:20px}
        .table-container{display:none}
        .mobile-card-view{display:block}
        .modal-content{
          width:100%;
          max-width:100%;
          height:100vh;
          max-height:100vh;
          border-radius:0;
          padding:20px 16px;
        }
        .form-group input,.form-group select{
          padding:14px;
          font-size:1rem;
          min-height:44px;
        }
        .btn{
          padding:12px 16px;
          min-height:44px;
          font-size:1rem;
        }
      }
      @media(max-width:480px){
        .content{padding:12px}
        h1{font-size:1.3rem}
        .mobile-card{padding:12px}
      }
    </style>
</head>
<body>
    <div class="app">
        <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeSidebar()"></div>
        <nav class="sidebar" id="sidebar">
            <div class="logo">InventoryPro</div>
            <ul>
                <li><a href="index.html">Dashboard</a></li>
                <li><a href="inventory.html">Inventory</a></li>
                <li class="active"><a href="orders.html">Orders</a></li>
                <li><a href="reports.html">Reports</a></li>
                <li><a href="settings.html">Settings</a></li>
            </ul>
        </nav>

        <div class="main">
            <header class="topbar">
                <button class="menu-btn" onclick="toggleSidebar()" aria-label="Toggle menu">â˜°</button>
                <input type="text" placeholder="Search orders..." class="global-search" id="globalSearch" onkeyup="filterOrders()">
                <div style="display:flex;align-items:center;gap:15px">
                    <div style="background:var(--primary);color:white;width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold">AD</div>
                </div>
            </header>

            <main class="content">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;flex-wrap:wrap;gap:12px">
            <h1>Orders Management</h1>
            <button class="btn btn-primary" onclick="openModal('newOrderModal')">+ New Order</button>
        </div>

        <div class="table-container">
            <table id="ordersTable">
                <thead>
                    <tr>
                        <th>Order ID</th><th>Customer</th><th>Items</th><th>Total</th><th>Status</th><th>Date</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
                <div class="mobile-card-view" id="mobileCardView"></div>
            </main>
        </div>
    </div>

    <!-- New Order Modal -->
    <div id="newOrderModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('newOrderModal')">&times;</span>
            <h2>Create New Order</h2>
            <form id="orderForm">
                <div class="form-group">
                    <label>Customer Name</label>
                    <input type="text" id="customerName" required>
                </div>
                <div class="form-group">
                    <label>Number of Items</label>
                    <input type="number" id="itemCount" value="1" min="1">
                </div>
                <div class="form-group">
                    <label>Total Amount ($)</label>
                    <input type="number" step="0.01" id="orderTotal" required>
                </div>
                <button type="submit" class="btn btn-success">Create Order</button>
            </form>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script>
        function loadOrders() {
            const orders = InventoryData.getOrders();
            const tbody = document.querySelector("#ordersTable tbody");
            const mobileView = document.getElementById("mobileCardView");
            const isMobile = window.innerWidth <= 768;
            
            // Desktop table
            tbody.innerHTML = orders.map(o => `
                <tr>
                    <td>${o.orderId}</td>
                    <td>${o.customer}</td>
                    <td>${o.items}</td>
                    <td>$${o.total}</td>
                    <td>
                        <select onchange="updateStatus(${o.id}, this.value)" style="padding:8px;border-radius:6px;border:1px solid #ddd;min-height:40px">
                            <option ${o.status==='Pending'?'selected':''}>Pending</option>
                            <option ${o.status==='Shipped'?'selected':''}>Shipped</option>
                            <option ${o.status==='Delivered'?'selected':''}>Delivered</option>
                        </select>
                    </td>
                    <td>${o.date}</td>
                    <td>
                        <button class="btn btn-danger btn-sm" onclick="deleteOrder(${o.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
            
            // Mobile cards
            if(mobileView){
                mobileView.innerHTML = orders.map(o => `
                    <div class="mobile-card">
                        <div class="mobile-card-header">
                            <div>
                                <div class="mobile-card-title">${o.orderId}</div>
                                <div style="color:var(--muted);font-size:0.85rem;margin-top:4px">${o.customer}</div>
                            </div>
                        </div>
                        <div class="mobile-card-row">
                            <span class="mobile-card-label">Items</span>
                            <span class="mobile-card-value">${o.items}</span>
                        </div>
                        <div class="mobile-card-row">
                            <span class="mobile-card-label">Total</span>
                            <span class="mobile-card-value">$${o.total}</span>
                        </div>
                        <div class="mobile-card-row">
                            <span class="mobile-card-label">Status</span>
                            <select onchange="updateStatus(${o.id}, this.value)" style="padding:10px;border-radius:8px;border:1px solid #ddd;min-height:44px;font-size:1rem;width:auto">
                                <option ${o.status==='Pending'?'selected':''}>Pending</option>
                                <option ${o.status==='Shipped'?'selected':''}>Shipped</option>
                                <option ${o.status==='Delivered'?'selected':''}>Delivered</option>
                            </select>
                        </div>
                        <div class="mobile-card-row">
                            <span class="mobile-card-label">Date</span>
                            <span class="mobile-card-value">${o.date}</span>
                        </div>
                        <div class="mobile-card-actions">
                            <button class="btn btn-danger" onclick="deleteOrder(${o.id})" style="flex:1">Delete</button>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function toggleSidebar(){
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('sidebarBackdrop');
            sidebar.classList.toggle('open');
            backdrop.classList.toggle('show');
        }
        function closeSidebar(){
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('sidebarBackdrop');
            sidebar.classList.remove('open');
            backdrop.classList.remove('show');
        }
        function filterOrders(){
            const term = document.getElementById('globalSearch').value.toLowerCase();
            document.querySelectorAll('.mobile-card, #ordersTable tbody tr').forEach(el => {
                const text = el.textContent.toLowerCase();
                el.style.display = text.includes(term) ? '' : 'none';
            });
        }
        
        // Close sidebar on nav click
        document.querySelectorAll('.sidebar a').forEach(link => {
            link.addEventListener('click', () => {
                if(window.innerWidth <= 768) closeSidebar();
            });
        });
        
        // Re-render on resize
        window.addEventListener('resize', () => {
            loadOrders();
        });
        
        function openModal(id){
            document.getElementById(id).classList.add('open');
        }
        function closeModal(id){
            document.getElementById(id).classList.remove('open');
        }

        function updateStatus(id, status) {
            const orders = InventoryData.getOrders().map(o => o.id === id ? {...o, status} : o);
            InventoryData.saveOrders(orders);
            loadOrders();
        }

        function deleteOrder(id) {
            if (confirm("Delete this order?")) {
                const orders = InventoryData.getOrders().filter(o => o.id !== id);
                InventoryData.saveOrders(orders);
                loadOrders();
            }
        }

        document.getElementById("orderForm").onsubmit = function(e) {
            e.preventDefault();
            const orders = InventoryData.getOrders();
            const newOrder = {
                id: Date.now(),
                orderId: "#ORD-" + (1000 + orders.length + 1),
                customer: document.getElementById("customerName").value,
                items: parseInt(document.getElementById("itemCount").value),
                total: parseFloat(document.getElementById("orderTotal").value),
                status: "Pending",
                date: new Date().toISOString().split("T")[0]
            };
            orders.push(newOrder);
            InventoryData.saveOrders(orders);
            loadOrders();
            closeModal("newOrderModal");
        };

        loadOrders();
    </script>
</body>
</html>